<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
    <head th:fragment="head(titulo)">
        <meta charset="UTF-8"/>
        <title th:replace="${titulo}"></title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <script src="https://kit.fontawesome.com/a52140e704.js" crossorigin="anonymous"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
        <link rel="stylesheet" th:href="@{/css/styles.css}"/>
    </head>
    <body>
        <header th:fragment="header" class="bg-primary text-white py-3">
            <div class="container">
                <div class="row">
                    <div class="col-md-6">
                        <h1 th:text="#{aplicacion.titulo}">Mi Aplicaci√≥n</h1>
                    </div>
                    <div class="col-md-6 text-end">
                        <nav>
                            <ul class="nav justify-content-end">
                                <li class="nav-item">
                                    <a class="nav-link text-white" th:href="@{/}">[[#{plantilla.inicio}]]</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-white" th:href="@{/categoria/principal}">[[#{plantilla.categorias}]]</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-white" th:href="@{/producto/principal}">[[#{plantilla.productos}]]</a>
                                </li>
                                </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </header>

        <section th:fragment="mensajesFlash">
            <div th:if="${session.successMessage}" class="alert alert-success alert-dismissible fade show mt-3 mx-auto" style="max-width: 500px;" role="alert">
                <span th:text="${session.successMessage}"></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            <div th:if="${session.errorMessage}" class="alert alert-danger alert-dismissible fade show mt-3 mx-auto" style="max-width: 500px;" role="alert">
                <span th:text="${session.errorMessage}"></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            <script th:if="${session.successMessage || session.errorMessage}">
                /*<![CDATA[*/
                sessionStorage.removeItem('successMessage');
                sessionStorage.removeItem('errorMessage');
                /*]]>*/
            </script>
        </section>

        <footer th:fragment="footer" class="bg-dark text-white mt-5 p-4">
            <div class="container">
                <div class="col">
                    <p class="lead text-center" th:text="#{plantilla.derechos}"></p>
                </div>
            </div>
        </footer>

        <section th:fragment="mostrarToast">
            <div class="toast-container position-fixed bottom-0 end-0 p-3">
                <div id="liveToast" class="toast align-items-center text-white bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true">
                    <div class="d-flex">
                        <div class="toast-body" id="toastMessage">
                            </div>
                        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
                    </div>
                </div>
            </div>

            <script th:inline="javascript">
                var successMessage = sessionStorage.getItem('successMessage');
                var errorMessage = sessionStorage.getItem('errorMessage');

                if (successMessage) {
                    $('#toastMessage').text(successMessage);
                    $('#liveToast').removeClass('bg-danger').addClass('bg-success');
                    new bootstrap.Toast(document.getElementById('liveToast')).show();
                    sessionStorage.removeItem('successMessage'); // Limpiar el mensaje
                } else if (errorMessage) {
                    $('#toastMessage').text(errorMessage);
                    $('#liveToast').removeClass('bg-success').addClass('bg-danger');
                    new bootstrap.Toast(document.getElementById('liveToast')).show();
                    sessionStorage.removeItem('errorMessage'); // Limpiar el mensaje
                }
                /*]]>*/
            </script>
        </section>
    </body>
</html>